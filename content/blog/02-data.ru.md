---
title: "Данные"
date: 2025-02-19
draft: true
---
Главная сложность этого проекта, конечно, данные. Во-первых, геоданные о железнодорожной сети, маршрутах и станциях. Во-вторых, расписание. Ну и данные о стоимости, типах вагонов и так далее.

## Геоданные
Весь этот сайт начался с небольшого локального упражнения: мне было интересно реализовать какую-то карту, используя данные [OpenStreetMap](https://www.openstreetmap.org/). Я активно контрибьютил в грузинскую часть OSM и имел представление о том, какая информация там есть.

В общем, железнодорожная сеть рисуется по данным OSM, после фильтрации второстепенных, узкоколейных и прочих не используемых для пассажирского сообщения путей. Запрос к [Overpass API](https://overpass-turbo.eu/) такой:
```
[out:json][timeout:25];
( area[name="საქართველო"]; )->.searchArea;
nwr["railway"="rail"]["usage"!="industrial"]["service"!="spur"]["service"!="yard"]["service"!="siding"](area.searchArea);
out geom;
```
Раньше я его зачем-то выполнял при каждом просмотре страницы, но теперь сырые данные от Overpass просто хранятся в проекте и загружаются почти мгновенно. Обновления там происходят не часто.

Маршруты, в виде отношений, тоже есть в OSM. Некоторые можно было использовать как есть, но большинство понадобилось сначала актуализировать или вообще добавить с нуля. Так что теперь, когда я узнаю об изменениях в маршруте, я сначала обновляю его в OSM. В конце концов, при клике на маршрут на карте сайт делает запрос в Overpass и показывает на карте линии и станции полученного маршрута.

## Расписание
Тут начинается главная боль. В [прошлой записи](/ru/blog/01-why-georailway/) я показывал, как выглядит расписание на официальном сайте. Со временем оказалось, что оно регулярно обновляется, синхронно с постами в группе ГЖД на Facebook. Я использую его для понимания какие вообще маршруты сейчас активны. Также, по изменению времени отправления или прибытия я могу косвенно узнать об изменениях в расписании маршрута в целом.

Но этого мало, нужно знать не только о конечных станциях, но и о промежуточных. Примерно на треть поездов продаются билеты онлайн. Вручную прокликав все возможные станции



